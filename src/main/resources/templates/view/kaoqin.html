

<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>xxx考勤打卡后台管理系统-明细查询</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
<!-- 基本样式 -->
<link rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet"
	href="../../static/admin/js/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet"
	href="../../static/admin/css/basic_css/font-awesome.min.css">
<link rel="stylesheet"
	href="../../static/admin/css/basic_css/animate.css">
<link rel="stylesheet"
	href="../../static/admin/../../static/admin/css/basic_css/index.css">
<link rel="stylesheet" href="../../static/admin/css/basic_css/style.css">

<!-- 自定义样式 -->
<link href="../../static/admin/css/basic_css/public.css"
	rel="stylesheet">
<link href="../../static/admin/css/basic_css/default.css"
	rel="stylesheet">
<link href="../../static/admin/css/basic_css/summary_statistics.css"
	rel="stylesheet">
<!-- 日期控件  href="js/plugins/layui/css/layui.css" -->
<link href="../../static/admin/js/layui/css/layui.css" rel="stylesheet">
<script src="../../static/admin/js/jquery/jQuery-2.2.0.min.js"></script>
<!-- 日期控件  src="js/plugins/layui/layui.js" -->

<script src="../../static/admin/js/layui/layui.js"
	type="text/javascript"></script>

<script src="../../static/admin/js/layer/laydate/laydate.js"></script>
<!-- 分页 css href="../../static/admin/css/basic_css/style_paging.css" -->
<link href="../../static/admin/css/basic_css/style_paging.css"
	rel="stylesheet"></link>
<!-- 分页 js rc="../../static/admin/js/pagination.min.js"-->
<script type="text/javascript"
	src="../../static/admin/js/pagination.min.js"></script>
<script type="text/javascript"
	src="../../static/admin/js/bootstrap/js/bootstrap.min.js"></script>


<style type="text/css">
.dianji {
	background: #00b5f9;
	border: 2px solid #00b5f9;
}
</style>


<script type="text/javascript">

 $(document).ready(function(){  

 chaxun();
         /*   $.ajax({
             url: "/punch/list",
             type: 'post',
             dataType:'json',           
             success: function (data) {
            
        for (var i = 0; i < data.length; i++) {
           var pid = data[i].punchId;
           var trs="";
        trs += '<tr id="' + pid + '">';
        trs += '<td>' + data[i].createTime + '</td>'; 
        trs += '<td>' + data[i].sysUser.department + '</td>'; 
        trs += '<td>' + data[i].sysUser.userName + '</td>'; 
        trs += '<td>' + data[i].sysUser.userCode + '</td>'; 
        trs += '<td>' + data[i].shiftName + '</td>';
        trs += '<td>' + data[i].punchStartTime + '</td>';     
        switch(data[i].signInState){
        case 1: trs += '<td>' + '正常' + '</td>';break;
        case 2: trs += '<td>' + '迟到' + '</td>';break;
        }
        trs += '<td>' + data[i].punchPlace + '</td>';
        trs += '<td>' + data[i].punchEndTime + '</td>';
        
        switch(data[i].signBackState){
        case 1: trs += '<td>' + '正常' + '</td>';break;
        case 2: trs += '<td>' + '早退' + '</td>';break;
        }     
        trs += '<td>' + data[i].signBackPlace + '</td>'; 
        trs += '<td>' + data[i].signBackReason + '</td>';
       switch(data[i].state){
       case 1: trs += '<td>' + '有效' + '</td>';break;
       case 2: trs += '<td>' + '无效' + '</td>';break;
       }
        //紫色 class="btn btn-primary btn-xs"
       trs += '<td><button href="#" class="btn btn-sm btn-info padding_0416"  data-toggle="modal" data-target="#myModal" data-target="#myModal" onclick="punchDetails('+pid+')">考勤详情</button></td>';
       trs += '</tr>';
         $("#tbs").append(trs); 
            } 
        } 
        })     */  
});



//页面数据展示 按钮！
function chaxun(){
	  //清空之前的
	   $("#tbs").empty(); 
         //时间
         var start = $("#start").val();
         var end = $("#end").val();
         //姓名工号
         var name = $("#name").val();
         var code = $("#code").val();
         //时间按钮
         var shijian=$("input[name='shijian']:checked").val();
         
           $.ajax({
             url: "/punch/list",
             type: 'post',       
             dataType: 'json',           
             data:{'username':name,'usercode':code,'beginDate':start,'endDate':end,'shijian':shijian}, 
             success: function (data) {
            

      for (var i = 0; i < data.length; i++) {
           var pid = data[i].punchId;
           var trs="";
        trs += '<tr id="' + pid + '">';
        trs += '<td>' + data[i].createTime + '</td>'; 
        trs += '<td>' + data[i].sysUser.department + '</td>'; 
        trs += '<td>' + data[i].sysUser.userName + '</td>'; 
        trs += '<td>' + data[i].sysUser.userCode + '</td>'; 
        trs += '<td>' + data[i].shiftName + '</td>';
        trs += '<td>' + data[i].punchStartTime + '</td>';     
        switch(data[i].signInState){
        case 1: trs += '<td>' + '正常' + '</td>';break;
        case 2: trs += '<td>' + '迟到' + '</td>';break;
        }
        trs += '<td>' + data[i].punchPlace + '</td>';
        trs += '<td>' + data[i].punchEndTime + '</td>';
        
        switch(data[i].signBackState){
        case 1: trs += '<td>' + '正常' + '</td>';break;
        case 2: trs += '<td>' + '早退' + '</td>';break;
        }     
        trs += '<td>' + data[i].signBackPlace + '</td>'; 
        trs += '<td>' + data[i].signBackReason + '</td>';
       switch(data[i].state){
       case 1: trs += '<td>' + '有效' + '</td>';break;
       case 2: trs += '<td>' + '无效' + '</td>';break;
       }
        //紫色 class="btn btn-primary btn-xs"
       trs += '<td><button href="#" class="btn btn-sm btn-info padding_0416"  data-toggle="modal" data-target="#myModal" data-target="#myModal" onclick="punchDetails('+pid+')">考勤详情</button></td>';
       trs += '</tr>';
         $("#tbs").append(trs); 
            } 
        }       
    })
    };
   
 
 //考勤详情 回显
 function punchDetails(pid){
    $.ajax({
        url: "/punch/list1",
        type: 'post',
        dataType: 'json',
        data: {"punchId": pid},
        success: function (data) {
 
                $("#bumen").val(data[0].sysUser.department);
                  $("#xingming").val(data[0].sysUser.userName);
                  $("#gonghao").val(data[0].sysUser.userCode);
                  $("#qiandao1").val(data[0].punchStartTime); 
                  $("#qiandao2").val(data[0].punchPlace);                
                  $("#qiandao3").val((data[0].signInState==1)?'正常':'迟到' );
                 
                  $("#qiantui1").val(data[0].punchEndTime);  
                  $("#qiantui2").val(data[0].signBackPlace);
                  $("#qiantui3").val((data[0].signBackState==1)?'正常':'早退');
                  $("#yuangongid").val(data[0].userId);
                  $("#shenfen").val(data[0].sysUser.cardNo);
                  $("#dianhua").val(data[0].sysUser.mobile);
                  $("#weixin").val(data[0].sysUser.openid);
                  $("#chuanshirenid").val(data[0].sysUser.createUserId);
                  $("#zhuangtai").val(data[0].state);             
        }
    });
 }

 

</script>
</head>
<body>

	<div id="areascontent" class=" padding_10">
		<div class="row margin_0">
			<!--  修改 start  -->
			<div class="box_search_div height_70">
				<!--  修改 end  -->
				<!-- 查询选项 -->
				<div class="box_search_div">
					<div class="box_search_div_one"
						style="width: 100%; float: left; margin:10px 0;">
						<div class="form-group">
							<label class="box_search_lable">日期：</label>
							<div class="col-sm-10" style="padding: 0">
								<div class="box_search_div_one date1"
									style="width:355px;padding-left:20px">
									<input type="radio" id="today" name="shijian" value="1">今天
									<input type="radio" id="tomorrow" name="shijian" value="2">昨天
									<input type="radio" id="week" name="shijian" value="3">本周
									<input type="radio" id="lastweek" name="shijian" value="4">上周
									<input type="radio" id="month" name="shijian" value="5">本月
									<input type="radio" id="lastmonth" name="shijian" value="6">上月
								</div>
								<div class="date2">
									<label class="box_search_lable">自定义日期：</label>
									 <input	placeholder="请输入开始日期" class="form-control layer-date f_l"
										id="start"> <span class="span_height f_l">&nbsp;&nbsp;-&nbsp;&nbsp;</span>
									<input placeholder="结束日期" class="form-control layer-date f_l"
										id="end">
								</div>
							</div>
						</div>
					</div>


					<div>
						<div class="box_search_div_one" style="width:323px;">
							<label class="box_search_lable">员工姓名：</label>
							<div class="box_search_input">
								<input type="text" class="form-control" placeholder="姓名搜索"
									id="name" name="">
							</div>
						</div>
						<div class="box_search_div_one" style="width:355px;">
							<label class="box_search_lable">员工工号：</label>
							<div class="box_search_input">
								<input type="text" class="form-control" placeholder="工号搜索"
									id="code" name="">
							</div>
						</div>

						<!--  -->
						<button type="button" class="btn btn-sm btn-info padding_0416"
							id="butCX" onclick="chaxun()">查询</button>

						<!--  -->
					</div>
				</div>

				<!-- 表格 -->
				<div>
					<table class="table table-bordered table-striped margin_b20">
						<thead>
							<tr>
								<th>日期</th>
								<th>部门</th>
								<th>姓名</th>
								<th>工号</th>
								<th>班次</th>
								<th>签到时间</th>
								<th>签到状态</th>
								<th>签到地点</th>
								<th>签退时间</th>
								<th>签退状态</th>
								<th>签退地点</th>
								<th>内容备注</th>
								<th>状态</th>




								<th>操作</th>
							</tr>
						</thead>
						<tbody id="tbs">

						</tbody>

					</table>
					<!--      <div id="Pagination" class="Pagination">
           <div id="Pagination" class="Pagination">这里显示分页</div>
                <div id="pagination_4" class="margin_b20" style="text-align: center;"></div> -->





					<!-- 模态框（Modal）start -->
					<div class="modal fade " id="myModal" tabindex="-1" role="dialog"
						aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true">&times;</button>
									<h4 class="modal-title" id="myModalLabel">考勤详细</h4>
								</div>
								<div class="modal-body">

									<div style="padding: 10px 10px 10px;">
										<div class="input-group input-group-sm"
											style="padding: 5px 5px 5px;margin:5px 5px 5px ">
											<span class="input-group-addon">部门</span> <input type="text"
												class="form-control" readonly id="bumen" value="">
											<!-- disabled="disabled" -->

											<span class="input-group-addon">姓名</span> <input type="text"
												class="form-control" placeholder="" value="" readonly
												id="xingming"> <span class="input-group-addon">工号</span>
											<input type="text" class="form-control" placeholder=""
												value="" readonly id="gonghao" />

										</div>

										<div class="input-group input-group-sm"
											style="padding: 5px 5px 5px;margin:5px 5px 5px ">
											<span class="input-group-addon">签到时间</span> <input
												type="text" class="form-control" placeholder="" value=""
												readonly id="qiandao1" /> <span class="input-group-addon">签到地点</span>
											<input type="text" class="form-control" placeholder=""
												value="" readonly id="qiandao2" />
										
											<span class="input-group-addon">签到状态</span>
											<input type="text" class="form-control" placeholder=""
												value="" readonly id="qiandao3" />
										
										</div>
									
										
			
										<div class="input-group input-group-sm" id="inx_two"
											style="padding: 5px 5px 5px;margin:5px 5px 5px ">
											<span class="input-group-addon">签退时间</span> <input
												type="text" class="form-control" placeholder="" value=""
												readonly id="qiantui1"> <span
												class="input-group-addon">签退地点</span> <input type="text"
												class="form-control" placeholder="" value="" readonly
												id="qiantui2">
											<!-- jia图片 -->
											<span class="input-group-addon">签退状态</span> <input
												type="text" class="form-control" placeholder="" value=""
												readonly id="qiantui3" />
										</div>
										<!-- 员工信息 -->
										<div class="input-group input-group-sm" id="inx_two"
											style="padding: 5px 5px 5px;margin:5px 5px 5px ">
											<span class="input-group-addon">员工ID</span> <input
												type="text" class="form-control" placeholder="" value=""
												readonly id="yuangongid"> <span
												class="input-group-addon">身份证号</span> <input type="text"
												class="form-control" placeholder="" value="" readonly
												id="shenfen">
										</div>
										<div class="input-group input-group-sm" id="inx_two"
											style="padding: 5px 5px 5px;margin:5px 5px 5px ">
											<span class="input-group-addon">电话号码</span> <input
												type="text" class="form-control" placeholder="" value=""
												readonly id="dianhua"> <span
												class="input-group-addon">微信号</span> <input type="text"
												class="form-control" placeholder="" value="" readonly
												id="weixin">
										</div>
										<div class="input-group input-group-sm" id="inx_two"
											style="padding: 5px 5px 5px;margin:5px 5px 5px ">
											<span class="input-group-addon">创建人ID</span> <input
												type="text" class="form-control" placeholder="" value=""
												readonly id="chuanshirenid"> <span
												class="input-group-addon">状态</span> <input type="text"
												class="form-control" placeholder="" value="" readonly
												id="zhuangtai">
										</div>

									</div>
								</div>

								<div class="modal-footer">
									<button type="button" class="btn btn-default"
										data-dismiss="modal">返回</button>
									<!--  <button type="button" class="btn btn-primary">提交邮寄</button> -->
								</div>
							</div>
							<!-- /.modal-content -->
						</div>
						<!-- /.modal -->
					</div>







				</div>
			</div>
		</div>

		<script type="text/javascript">
       //日期范围限制
        var start = {
            elem: '#start',
            format: 'YYYY-MM-DD',
             min: '2000-1-1', //设定最小日期为当前日期
            max: laydate.now(), //最大日期
            //istime: true,
            istoday: false,
            showBottom :false,
            btns: [ 'confirm']
        };
        var end = {
            elem: '#end',
            format: 'YYYY-MM-DD',
            min: '2000-1-1',
            max: laydate.now(),
           // istime: true,
            istoday: false,
            choose: function (datas) {
                start.max = datas; //结束日选好后，重置开始日的最大日期
            }
        };
        laydate(start);
        laydate(end);
       

       //按钮和时间只能选一个
       $('.date1 input').click(function(){
       		$('.date2 input').val('');
       })
        $('.date2 input').click(function(){
       		 $('.date1 input').attr("checked",false);
       })  
       
</script>
</body>



</html>
